(this.webpackJsonpvgig=this.webpackJsonpvgig||[]).push([[0],{1003:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(32),o=n.n(c),i=(n(877),n(48)),l=n(129),u=n(39),s=n(49),m=n(12),d=n(1035),h=n(1034),f=n(34);function g(){var e=Object(i.a)(["\n  margin-top: 92px;\n  text-align: center;\n"]);return g=function(){return e},e}function p(){var e=Object(i.a)(["\n  p {\n    margin-top: 24px;\n    margin-bottom: 24px;\n  }\n"]);return p=function(){return e},e}function v(){var e=Object(i.a)([""]);return v=function(){return e},e}function b(){var e=Object(i.a)(["\n  position: fixed;\n  padding: 25px;\n  top: 0;\n  right: 0%;\n"]);return b=function(){return e},e}function j(){var e=Object(i.a)(["\n  max-width: 768px;\n  margin: auto;\n  margin-top: 100px;\n"]);return j=function(){return e},e}var O=n(828).version,E=s.a.div(j()),w=s.a.div(b()),M=s.a.section(v()),y=s.a.section(p()),k=s.a.div(g()),x=function(){var e=Object(a.useState)(function(e){for(var t="",n="abcdefghijklmnopqrstuvwxyz0123456789",a=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return t}(4)),t=Object(m.a)(e,2),n=t[0],c=t[1],o=Object(u.f)();return r.a.createElement(E,null,r.a.createElement(w,null,O),r.a.createElement(M,null,"Welcome to vgig,",r.a.createElement("br",null),"the virtual concert hall for everyone."),r.a.createElement(y,null,r.a.createElement("p",null),r.a.createElement(k,null,r.a.createElement(h.a,{value:n,onChange:function(e){return c(e.target.value)}}),r.a.createElement(d.a,{onClick:function(){"running"!==f.h.state&&f.h.resume(),o.push("halls/".concat(n))}},"enter"))))},C=n(13),S=n(1),A=n(142),I=n(20),R=n(146),B=["#A2CCB6","#FCEEB5","#EE786E","#e0feff","lightpink","lightblue"],D=["planeBufferGeometry","planeBufferGeometry","planeBufferGeometry"],z=function(e){var t=Math.random();return{position:[100-200*Math.random(),100-200*Math.random(),1.5*e],color:B[Math.round(Math.random()*(B.length-1))],scale:[1+14*t,1+14*t,1],rotation:[0,0,S.Math.degToRad(45*Math.round(Math.random()))]}},N=new Array(35).fill().map((function(){return{shape:D[Math.round(Math.random()*(D.length-1))],color:B[Math.round(Math.random()*(B.length-1))],args:[.1+9*Math.random(),.1+9*Math.random(),10]}}));function G(){var e=Object(R.b)(35,(function(e){return Object(C.a)({from:z(e)},z(e),{config:{mass:20,tension:150,friction:50}})})),t=Object(m.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){setInterval((function(){return c((function(e){return Object(C.a)({},z(e),{delay:40*e})}))}),3e3)}),[c]),N.map((function(e,t){return r.a.createElement(R.a.mesh,Object.assign({key:t},n[t],{castShadow:!0,receiveShadow:!0}),r.a.createElement("boxBufferGeometry",{args:e.args}),r.a.createElement(R.a.meshStandardMaterial,{color:n[t].color,roughness:.75,metalness:.5}))}))}function T(){return r.a.createElement("group",null,r.a.createElement("pointLight",{intensity:.3}),r.a.createElement("ambientLight",{intensity:2}),r.a.createElement("spotLight",{castShadow:!0,intensity:.2,angle:Math.PI/7,position:[150,150,250],penumbra:1,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}))}var _=function(){return r.a.createElement(I.a,{style:{background:"rgb(0,0,0)"},camera:{position:[0,0,100],fov:1e3}},r.a.createElement(T,null),r.a.createElement("mesh",{receiveShadow:!0},r.a.createElement("planeBufferGeometry",{args:[1e3,1e3]}),r.a.createElement("meshStandardMaterial",{color:"#A2ACB6",roughness:1})),r.a.createElement(G,null),r.a.createElement(A.a,null))},q=144,J=128,L=n(840),W=n.n(L),P=n(841),V=n.n(P),$=n(842),F=n(15),H=n(843),K=function(e){return e.includes("#")||e.includes("+")};var Q=function(e){var t=Object(H.connect)(e),n=new Map;return t.on("connect",console.log),t.on("disconnect",console.log),t.on("error",console.error),t.on("message",(function(e,t){console.log("on message",e,n.size),n.forEach((function(n,a){console.log("listener",a),(e===a||K(a)&&function(e,t){if(e===t)return[];if("#"===t)return[e];for(var n=[],a=String(e).split("/"),r=String(t).split("/"),c=0,o=a.length;c<o;c++)if("+"===r[c])n.push(a[c]);else{if("#"===r[c])return n.push(a.slice(c).join("/")),n;if(r[c]!==a[c])return null}return"#"===r[c]&&(c+=1),c===r.length?n:null}(e,a))&&n.forEach((function(e){console.log("listener for topic",a,e);try{e(a,JSON.parse(t.toString()))}catch(n){e(a,{})}}))}))})),function(){return{subscribe:function(e,a){var r=n.get(e);if(n.set(e,[].concat(Object(F.a)(r||[]),[a])),t.subscribe(e),!n.get(e))throw new Error("useClient: ".concat(e," does not exist"))},publish:function(e,n){if(K(e))throw new Error("useTopic: Tried publishing on wildcard topic ".concat(e));t.publish(e,JSON.stringify(n))},unsubscribe:function(e){n.delete(e),t.unsubscribe(e)},getClient:function(){return t}}}}("wss://try:try@broker.shiftr.io"),U="vgig";function X(){var e=Object(i.a)(["\n  width: 100%;\n  height: 66%;\n"]);return X=function(){return e},e}var Y={C3:W.a},Z={C3:V.a},ee=s.a.div(X());function te(e){var t=e.curve,n=e.width,c=e.color,o=e.speed,i=Object(a.useRef)();return Object(I.g)((function(){return i.current.uniforms.dashOffset.value-=o})),r.a.createElement("mesh",null,r.a.createElement("meshLine",{attach:"geometry",vertices:t}),r.a.createElement("meshLineMaterial",{attach:"material",ref:i,transparent:!0,depthTest:!1,lineWidth:n,color:c,dashArray:.1,dashRatio:.9}))}function ne(e){var t=e.count,n=e.colors;return Object(a.useMemo)((function(){return new Array(t).fill().map((function(){var e=new S.Vector3(10-20*Math.random(),10-20*Math.random(),10-20*Math.random()),t=new Array(30).fill().map((function(){return e.add(new S.Vector3(4-8*Math.random(),4-8*Math.random(),2-4*Math.random())).clone()})),a=new S.CatmullRomCurve3(t).getPoints(1e3);return{color:n[parseInt(n.length*Math.random())],width:Math.max(.1,.65*Math.random()),speed:Math.max(1e-4,5e-4*Math.random()),curve:a}}))}),[n,t]).map((function(e,t){return r.a.createElement(te,Object.assign({key:t},e))}))}Object(I.e)($);var ae=function(e){var t=e.id,n=Object(a.useState)(null),c=Object(m.a)(n,2),o=c[0],i=c[1],l=Object(a.useState)(null),u=Object(m.a)(l,2),s=u[0],d=u[1],h=Object(a.useState)(null),g=Object(m.a)(h,2),p=g[0],v=g[1],b=Object(a.useState)(null),j=Object(m.a)(b,2),O=j[0],E=j[1],w=Object(a.useState)(null),M=Object(m.a)(w,2),y=M[0],k=M[1],x=Q(),C=x.subscribe,S=x.unsubscribe;return Object(a.useEffect)((function(){var e=new f.g(Y);e.volume.value=-6;var t=new f.c(.6,5e3),n=new f.f({delayTime:"32n",feedback:.7,wet:.25});e.volume.value=0,e.connect(n),n.connect(t),t.connect(f.a),i(e);var a=new f.g(Z);a.volume.value=0,a.connect(f.a),d(a);var r=new f.b({volume:0,detune:0,portamento:0,harmonicity:3,oscillator:{partialCount:0,partials:[],phase:0,type:"sine"},envelope:{attack:.01,attackCurve:"linear",decay:.2,decayCurve:"exponential",release:.5,releaseCurve:"exponential",sustain:1},modulation:{partialCount:0,partials:[],phase:0,type:"square"},modulationEnvelope:{attack:.2,attackCurve:"linear",decay:.01,decayCurve:"exponential",release:.5,releaseCurve:"exponential",sustain:1},modulationIndex:12.22});r.connect(f.a),v(r);var c=new f.d({frequency:200,envelope:{attack:.001,decay:1.4,release:.2},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5});c.connect(f.a),E(c);var o=new f.e;o.connect(f.a),k(o)}),[]),Object(a.useEffect)((function(){C("".concat(U,"/").concat(t,"/orchestra"),(function(e,t){console.log(t);var n=t.channel,a=t.note,r=t.status;switch(n){case 1:o&&o.triggerAttackRelease(a);break;case 2:s&&s.triggerAttackRelease(a);break;case 3:p&&r===q&&p.triggerAttack(a),p&&r===J&&p.triggerRelease(a);break;case 4:O&&r===q&&O.triggerAttack(a),O&&r===J&&O.triggerRelease(a);break;case 5:y&&r===q&&y.triggerAttack(),y&&r===J&&y.triggerRelease()}}))}),[o,s,t],(function(){S("".concat(U,"/").concat(t,"/orchestra"))})),r.a.createElement(ee,null,r.a.createElement(I.a,{style:{background:"rgb(0,0,0)"},camera:{position:[0,0,10],fov:25}},r.a.createElement(ne,{count:20,colors:["rgb(100,0,0)","#222","#aaa","#e0feff","rgb(100,0,60)","rgb(127,32,64)"]}),r.a.createElement(A.a,null)))},re=function(e){for(var t="",n="abcdefghijklmnopqrstuvwxyz0123456789",a=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return t},ce=r.a.createContext(),oe=function(e){var t=e.children,n=Object(a.useState)({userId:re(8)}),c=Object(m.a)(n,2),o=c[0],i=c[1];return r.a.createElement(ce.Provider,{value:[o,i]},t)},ie=ce,le=n(844),ue=n.n(le),se=n(845),me=n.n(se),de=n(846),he=n.n(de),fe=n(847),ge=n.n(fe),pe=n(848),ve=n.n(pe),be=n(849),je=n.n(be),Oe=n(141),Ee=n.n(Oe),we=n(850),Me=n.n(we),ye=n(851),ke=n.n(ye),xe=n(852),Ce=n.n(xe);function Se(){var e=Object(i.a)(["\nposition: absolute;\ntop: 0;\nright: 0;\nwidth: 33.33vw;\nheight: 100vh;\nbackground-color: rgba(144,238,144,0.7);\n"]);return Se=function(){return e},e}var Ae=s.a.div(Se()),Ie=["applaude","talk","photograph","walk","sneeze","cough","dance","scream","sing along","phone"],Re=function(){var e=Object(a.useContext)(ie),t=Object(m.a)(e,1)[0],n=Q(),c=n.subscribe,o=n.publish,i=n.getClient,l=Object(a.useState)(null),u=Object(m.a)(l,2),s=u[0],h=u[1],g=Object(a.useState)(null),p=Object(m.a)(g,2),v=p[0],b=(p[1],Object(a.useState)(null)),j=Object(m.a)(b,2),O=j[0],E=j[1],w=Object(a.useState)(null),M=Object(m.a)(w,2),y=M[0],k=M[1],x=Object(a.useState)(null),C=Object(m.a)(x,2),S=C[0],A=C[1],I=Object(a.useState)(null),R=Object(m.a)(I,2),B=R[0],D=R[1],z=Object(a.useState)(null),N=Object(m.a)(z,2),G=N[0],T=N[1],_=Object(a.useState)(null),q=Object(m.a)(_,2),J=q[0],L=q[1],W=Object(a.useState)(null),P=Object(m.a)(W,2),V=P[0],$=P[1],F=Object(a.useState)(null),H=Object(m.a)(F,2),K=H[0],X=H[1],Y=Object(a.useState)(null),Z=Object(m.a)(Y,2),ee=Z[0];Z[1];return Object(a.useEffect)((function(){var e=new f.g({C3:ue.a});e.toDestination(),e.volume.value=.2,E(e);var t=new f.g({C3:ve.a});t.toDestination(),t.volume.value=.2,A(t);var n=new f.g({C2:me.a,C3:he.a,C4:ge.a});n.toDestination(),n.volume.value=.2,k(n);var a=new f.g({C3:je.a});a.toDestination(),a.volume.value=.2,h(a);var r=new f.g({C3:Me.a});r.toDestination(),r.volume.value=.2,D(r);var c=new f.g({C3:ke.a});c.toDestination(),c.volume.value=.2,T(c);var o=new f.g({C3:Ce.a});o.toDestination(),o.volume.value=.2,X(o);var l=new f.g({C3:Ee.a});l.toDestination(),l.volume.value=.2,L(l);var u=new f.g({C3:Ee.a});u.toDestination(),u.volume.value=.2,$(u),i().on("connect",(function(){console.log("client connected")}))}),[]),Object(a.useEffect)((function(){c("".concat(U,"/").concat(t.hallId,"/applaude"),(function(e,t){O.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),c("".concat(U,"/").concat(t.hallId,"/talk"),(function(e,t){y.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),c("".concat(U,"/").concat(t.hallId,"/singAlong"),(function(e,t){S.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),c("".concat(U,"/").concat(t.hallId,"/enter"),(function(e,t){s.triggerAttackRelease(72,20),console.log("user entered",t)})),c("".concat(U,"/").concat(t.hallId,"/leave"),(function(e,t){console.log("user left",t)})),c("".concat(U,"/").concat(t.hallId,"/photograph"),(function(e,t){B.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),c("".concat(U,"/").concat(t.hallId,"/phone"),(function(e,t){G.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),c("".concat(U,"/").concat(t.hallId,"/walk"),(function(e,t){K.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),c("".concat(U,"/").concat(t.hallId,"/sneeze"),(function(e,t){J.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),c("".concat(U,"/").concat(t.hallId,"/cough"),(function(e,t){V.triggerAttackRelease(40+Math.round(60*Math.random()),20)}))}),[t.hallId,O,y,S,K,G,B,ee,V,J,s,v]),r.a.createElement(Ae,null,Ie.map((function(e){return r.a.createElement(d.a,{key:e,variant:"contained",color:"primary",onClick:function(){o("".concat(U,"/").concat(t.hallId,"/").concat(e),{userId:t.userId})}},e)})))};function Be(){var e=Object(i.a)(["\n    .audience {\n        width: 100%;\n        height: 33%;\n    }\n    width: 100%;\n    height: 100%;\n"]);return Be=function(){return e},e}var De=s.a.div(Be()),ze=function(){var e=Object(u.g)().id,t=Object(a.useContext)(ie),n=Object(m.a)(t,2),c=n[0],o=n[1],i=Q().publish;return Object(a.useEffect)((function(){console.log("entering"),o(Object(C.a)({},c,{hallId:e})),i("".concat(U,"/").concat(e,"/enter"),{userId:c.userId})}),[e]),r.a.createElement(De,null,r.a.createElement(ae,{className:"orchestra",id:e}),r.a.createElement(_,{className:"audience",id:e}),r.a.createElement(Re,{className:"interactions",id:e}))};function Ne(){var e=Object(i.a)(["\n  width: 100vw;\n  height: 100vh;\n"]);return Ne=function(){return e},e}var Ge=s.a.div(Ne()),Te=function(){return r.a.createElement(Ge,null,r.a.createElement(l.a,null,r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/halls/:id"},r.a.createElement(oe,{value:ie},r.a.createElement(ze,null))),r.a.createElement(u.a,{path:"/"},r.a.createElement(x,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},141:function(e,t,n){e.exports=n.p+"static/media/sneeze.62f3207f.mp3"},828:function(e){e.exports=JSON.parse('{"name":"vgig","homepage":"https://thomasgeissl.github.io/vgig","version":"0.1.0","private":true,"dependencies":{"@material-ui/core":"^4.11.0","@material-ui/icons":"^4.9.1","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.3.2","@testing-library/user-event":"^7.1.2","drei":"^1.5.7","gh-pages":"^3.1.0","mqtt":"^4.2.1","nosleep.js":"^0.11.0","react":"^16.13.1","react-dom":"^16.13.1","react-redux":"^7.2.1","react-router-dom":"^5.2.0","react-scripts":"3.4.3","react-spring":"^8.0.27","react-three-fiber":"^5.0.1","redux":"^4.0.5","styled-components":"^5.2.0","three":"^0.120.1","threejs-meshline":"^2.0.12","tone":"^14.7.39","typescript":"^4.0.3"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","deploy":"yarn build && gh-pages -d build","travisdeploy":"CI=false yarn build && gh-pages -d build -r https://$GH_TOKEN@github.com/thomasgeissl/vgig.git"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},840:function(e,t,n){e.exports=n.p+"static/media/A.5e794cdb.mp3"},841:function(e,t,n){e.exports=n.p+"static/media/violin_c3.bbc9708e.mp3"},844:function(e,t,n){e.exports=n.p+"static/media/clapping.31212348.mp3"},845:function(e,t,n){e.exports=n.p+"static/media/talk_C2.4fdd1dcf.mp3"},846:function(e,t,n){e.exports=n.p+"static/media/talk_C3.f2a775cc.mp3"},847:function(e,t,n){e.exports=n.p+"static/media/talk_C4.cfab9d69.mp3"},848:function(e,t,n){e.exports=n.p+"static/media/singAlong.6896ef66.mp3"},849:function(e,t,n){e.exports=n.p+"static/media/enter.339b495d.mp3"},850:function(e,t,n){e.exports=n.p+"static/media/photograph.437bf6fd.mp3"},851:function(e,t,n){e.exports=n.p+"static/media/phone.9417a5f0.mp3"},852:function(e,t,n){e.exports=n.p+"static/media/walk.6a028ea7.mp3"},873:function(e,t,n){e.exports=n(1003)},877:function(e,t,n){},900:function(e,t){},902:function(e,t){},971:function(e,t){},973:function(e,t){},996:function(e,t){},997:function(e,t){}},[[873,1,2]]]);
//# sourceMappingURL=main.d7933659.chunk.js.map