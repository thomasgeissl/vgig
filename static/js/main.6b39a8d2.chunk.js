(this.webpackJsonpvgig=this.webpackJsonpvgig||[]).push([[0],{1006:function(e,t){},1008:function(e,t){},1031:function(e,t){},1032:function(e,t){},1044:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(30),o=n.n(r),i=(n(919),n(49)),u=n(140),s=n(151),l=n(42),d=n(50),p=n(12),f=n(1084),b=n(1082),h=n(37);function g(){var e=Object(i.a)(["\n  margin-top: 92px;\n  text-align: center;\n"]);return g=function(){return e},e}function v(){var e=Object(i.a)(["\n  p {\n    margin-top: 24px;\n    margin-bottom: 24px;\n  }\n"]);return v=function(){return e},e}function m(){var e=Object(i.a)([""]);return m=function(){return e},e}function O(){var e=Object(i.a)(["\n  position: fixed;\n  padding: 25px;\n  top: 0;\n  right: 0%;\n"]);return O=function(){return e},e}function j(){var e=Object(i.a)(["\n  max-width: 768px;\n  margin: auto;\n  margin-top: 100px;\n"]);return j=function(){return e},e}var E=n(864).version,w=d.a.div(j()),y=d.a.div(O()),S=d.a.section(m()),k=d.a.section(v()),x=d.a.div(g()),C=function(){var e=Object(a.useState)(function(e){for(var t="",n="abcdefghijklmnopqrstuvwxyz0123456789",a=n.length,c=0;c<e;c++)t+=n.charAt(Math.floor(Math.random()*a));return t}(4)),t=Object(p.a)(e,2),n=t[0],r=t[1],o=Object(l.f)();return c.a.createElement(w,null,c.a.createElement(y,null,E),c.a.createElement(S,null,"Welcome to vgig,",c.a.createElement("br",null),"the virtual concert hall for everyone."),c.a.createElement(k,null,c.a.createElement("p",null),c.a.createElement(x,null,c.a.createElement(b.a,{value:n,onChange:function(e){return r(e.target.value)}}),c.a.createElement(f.a,{onClick:function(){"running"!==h.j.state&&h.j.resume(),o.push("/halls/".concat(n))}},"enter"))))},A=n(13),I=n(1086),R=n(16),T=n(165),M=n.n(T),D=function(e){return e.includes("#")||e.includes("+")};var U=function(e){var t=Object(T.connect)(e),n=new Map;return t.on("connect",console.log),t.on("disconnect",console.log),t.on("error",console.error),t.on("message",(function(e,t){n.forEach((function(n,a){(e===a||D(a)&&function(e,t){if(e===t)return[];if("#"===t)return[e];for(var n=[],a=String(e).split("/"),c=String(t).split("/"),r=0,o=a.length;r<o;r++)if("+"===c[r])n.push(a[r]);else{if("#"===c[r])return n.push(a.slice(r).join("/")),n;if(c[r]!==a[r])return null}return"#"===c[r]&&(r+=1),r===c.length?n:null}(e,a))&&n.forEach((function(e){try{e(a,JSON.parse(t.toString()))}catch(n){e(a,{})}}))}))})),function(){return{subscribe:function(e,a){var c=n.get(e);if(n.set(e,[].concat(Object(R.a)(c||[]),[a])),t.subscribe(e),!n.get(e))throw new Error("useClient: ".concat(e," does not exist"))},publish:function(e,n){if(D(e))throw new Error("useTopic: Tried publishing on wildcard topic ".concat(e));t.publish(e,JSON.stringify(n))},unsubscribe:function(e){n.delete(e),t.unsubscribe(e)},getClient:function(){return t}}}}("wss://try:try@broker.shiftr.io"),_="vgig",N=M.a.connect("wss://try:try@broker.shiftr.io"),B=function(e,t){N.publish(e,JSON.stringify(t))},H=function(e){for(var t="",n="abcdefghijklmnopqrstuvwxyz0123456789",a=n.length,c=0;c<e;c++)t+=n.charAt(Math.floor(Math.random()*a));return t},z=c.a.createContext(),J=function(e){var t=e.children,n=Object(a.useState)({userId:H(8)}),r=Object(p.a)(n,2),o=r[0],i=r[1];return c.a.createElement(z.Provider,{value:[o,i]},t)},q=z,G={ADDUSER:"ADDUSER",SETUSERS:"SETUSERS",HEARTBEAT:"HEARTBEAT"},P={users:[],heartBeats:new Map},W=n(90),F=n(1083),V="ADDMESSAGE",X={messages:[]},$=Object(W.c)({users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G.HEARTBEAT:var n=new Map(e.heartBeats),a=Object(R.a)(e.users);return n.set(t.payload.value,Date.now()),n.forEach((function(e,t){if(Date.now()>e+1e4){n.delete(t);var c=a.indexOf(t);-1!==c&&a.splice(c,1)}})),Object(A.a)({},e,{heartBeats:n,users:a});case G.SETUSERS:var c=[].concat(Object(R.a)(e.users),Object(R.a)(t.payload.value)).sort();return Object(A.a)({},e,{users:c.filter((function(e,t){return c.indexOf(e)===t}))});case G.ADDUSER:var r=Object(R.a)(e.users);return r.includes(t.payload.value)||r.push(t.payload.value),Object(A.a)({},e,{users:r.sort()});default:return e}},chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V:var n=Object(R.a)(e.messages);return n.unshift(t.payload.message),n=n.splice(0,100),Object(A.a)({},e,{messages:n});default:return e}}}),K=n(1079),L=n(1080),Q=n(171),Y=n(1081),Z=n(1087),ee=Object(F.a)(),te=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||W.d,ne=Object(W.e)((function(e,t){return"RESET"===t.type?$(void 0,t):"SETSTATE"===t.type?$(t.payload,{type:"IGNORE"}):$(e,t)}),te(Object(W.a)(ee)));ee.run((function(e){return e.pipe(Object(K.a)((function(e){return"STARTHEARTBEAT"===e.type})),Object(L.a)((function(t){return Object(Z.a)(3e4).pipe(Object(Q.a)((function(e){return{type:"HEARTBEAT",payload:{value:1}}})),Object(Y.a)(e.ofType("STOPHEARTBEAT")))})))})),ne.dispatch({type:"INIT"});var ae=ne;function ce(){var e=Object(i.a)(["\nheight: 25px;\nwidth: 25px;\nbackground-color: ",";\nborder-radius: 50%;\ndisplay: inline-block;\nmargin: 5px;\nborder: 1px solid black;\n"]);return ce=function(){return e},e}function re(){var e=Object(i.a)(["\n  background-color: #448FA3;\n  height: 33.33vh;\n  width: 100%;\n"]);return re=function(){return e},e}var oe=d.a.div(re()),ie=d.a.div(ce(),(function(e){return e.active?"#0197F6":"#E2D388"})),ue=function(e){var t=e.id,n=Object(u.b)(),r=U(),o=r.subscribe,i=r.unsubscribe,s=Object(a.useContext)(q),l=Object(p.a)(s,2),d=l[0],f=(l[1],Object(u.c)((function(e){return e.users.users})));Object(a.useCallback)((function(){return f}));return Object(a.useEffect)((function(){t&&(o("".concat(_,"/").concat(t,"/getUsers"),(function(e,n){n.from&&n.from!==d.userId&&B("".concat(_,"/").concat(t,"/setUsers"),ae.getState().users.users)})),o("".concat(_,"/").concat(t,"/setUsers"),(function(e,t){n({type:G.SETUSERS,payload:{value:t}})})),o("".concat(_,"/").concat(t,"/enter"),(function(e,t){var a;n((a=t.userId,{type:G.ADDUSER,payload:{value:a}}))})),o("".concat(_,"/").concat(t,"/alive"),(function(e,t){console.log("user is alive",t)})),B("".concat(_,"/").concat(t,"/getUsers"),{from:d.userId}),setInterval((function(){B("".concat(_,"/").concat(t,"/alive"),{userId:d.userId})}),3e4))}),[t],(function(){i("".concat(_,"/").concat(t,"/getUsers"))})),c.a.createElement(oe,null,f.map((function(e,t){f.length;return c.a.createElement(I.a,{key:e,title:e,placement:"right-start"},c.a.createElement(ie,{key:e,active:d.userId===e}))})))},se=144,le=128,de=n(869),pe=n.n(de),fe=n(870),be=n.n(fe),he=(n(1),n(871)),ge=n(21);Object(ge.e)(he);var ve=n(892);function me(){var e=Object(i.a)(["\n  width: 100%;\n  height: 66.66%;\n"]);return me=function(){return e},e}var Oe=d.a.div(me()),je=function(e){var t=e.id,n=Object(a.useState)(null),r=Object(p.a)(n,2),o=(r[0],r[1]),i=Object(a.useState)(null),u=Object(p.a)(i,2),s=(u[0],u[1]),l=Object(a.useState)(null),d=Object(p.a)(l,2),f=d[0],b=d[1],g=Object(a.useState)(null),v=Object(p.a)(g,2),m=v[0],O=v[1],j=Object(a.useState)(null),E=Object(p.a)(j,2),w=E[0],y=E[1],S=Object(a.useState)(null),k=Object(p.a)(S,2),x=k[0],C=k[1],A=Object(a.useState)(null),I=Object(p.a)(A,2),R=I[0],T=I[1],M=Object(a.useState)([]),D=Object(p.a)(M,2),N=(D[0],D[1]),B=U(),H=B.subscribe,z=B.unsubscribe;return Object(a.useEffect)((function(){var e=new h.b;e.connect(h.c),o(e);var t=new h.a;e.connect(t),s(t),setInterval((function(){t&&N(t.getValue())}),50);var n=new h.i({C3:pe.a}),a=new h.e(.6,5e3),c=new h.h({delayTime:"32n",feedback:.7,wet:.25});n.volume.value=0,n.connect(c),c.connect(a),a.connect(e),b(n);var r=new h.i({C3:be.a});r.volume.value=0,r.connect(e),O(r);var i=new h.d({volume:0,detune:0,portamento:0,harmonicity:3,oscillator:{partialCount:0,partials:[],phase:0,type:"sine"},envelope:{attack:.01,attackCurve:"linear",decay:.2,decayCurve:"exponential",release:.5,releaseCurve:"exponential",sustain:1},modulation:{partialCount:0,partials:[],phase:0,type:"square"},modulationEnvelope:{attack:.2,attackCurve:"linear",decay:.01,decayCurve:"exponential",release:.5,releaseCurve:"exponential",sustain:1},modulationIndex:12.22});i.connect(e),y(i);var u=new h.f({frequency:200,envelope:{attack:.001,decay:1.4,release:.2},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5});u.connect(e),C(u);var l=new h.g;l.connect(e),T(l)}),[]),Object(a.useEffect)((function(){H("".concat(_,"/").concat(t,"/orchestra"),(function(e,t){console.log(t);var n=t.channel,a=t.note,c=t.status;switch(n){case 1:f&&f.triggerAttackRelease(a);break;case 2:m&&m.triggerAttackRelease(a);break;case 3:w&&c===se&&w.triggerAttack(a),w&&c===le&&w.triggerRelease(a);break;case 4:x&&c===se&&x.triggerAttack(a),x&&c===le&&x.triggerRelease(a);break;case 5:R&&c===se&&R.triggerAttack(),R&&c===le&&R.triggerRelease()}}))}),[f,m,t],(function(){z("".concat(_,"/").concat(t,"/orchestra"))})),c.a.createElement(Oe,null,c.a.createElement(ge.a,{style:{background:"rgb(0,0,0)"},camera:{position:[0,0,10],fov:25}},c.a.createElement(ve.a,null)))},Ee=n(880),we=n.n(Ee),ye=n(881),Se=n.n(ye),ke=n(882),xe=n.n(ke),Ce=n(883),Ae=n.n(Ce),Ie=n(884),Re=n.n(Ie),Te=n(885),Me=n.n(Te),De=n(198),Ue=n.n(De),_e=n(886),Ne=n.n(_e),Be=n(887),He=n.n(Be),ze=n(888),Je=n.n(ze),qe=n(889),Ge=n.n(qe),Pe=n(890),We=n.n(Pe),Fe=n(891),Ve=n.n(Fe);function Xe(){var e=Object(i.a)(["\n    background-color: rgba(68,143,163,1);\n    border: none;\n    color: white;\n    padding: 15px 32px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 5px;\n"]);return Xe=function(){return e},e}function $e(){var e=Object(i.a)(["\n    position: absolute;\n    top: 0;\n    right: 0;\n    width: 33.33vw;\n    height: 100vh;\n    background-color: rgb(2,24,43); /* Green */\n"]);return $e=function(){return e},e}var Ke=d.a.div($e()),Le=d.a.button(Xe()),Qe=["applaude","talk","photograph","walk","sneeze","cough","dance","shout","singAlong","phone"],Ye=function(){var e=Object(a.useContext)(q),t=Object(p.a)(e,1)[0],n=U(),r=n.subscribe,o=n.publish,i=n.getClient,u=Object(a.useState)(null),s=Object(p.a)(u,2),l=s[0],d=s[1],f=Object(a.useState)(null),b=Object(p.a)(f,2),g=b[0],v=b[1],m=Object(a.useState)(null),O=Object(p.a)(m,2),j=O[0],E=O[1],w=Object(a.useState)(null),y=Object(p.a)(w,2),S=y[0],k=y[1],x=Object(a.useState)(null),C=Object(p.a)(x,2),A=C[0],I=C[1],R=Object(a.useState)(null),T=Object(p.a)(R,2),M=T[0],D=T[1],N=Object(a.useState)(null),B=Object(p.a)(N,2),H=B[0],z=B[1],J=Object(a.useState)(null),G=Object(p.a)(J,2),P=G[0],W=G[1],F=Object(a.useState)(null),V=Object(p.a)(F,2),X=V[0],$=V[1],K=Object(a.useState)(null),L=Object(p.a)(K,2),Q=L[0],Y=L[1],Z=Object(a.useState)(null),ee=Object(p.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(null),ce=Object(p.a)(ae,2),re=ce[0],oe=ce[1],ie=Object(a.useState)(null),ue=Object(p.a)(ie,2),se=(ue[0],ue[1]);return Object(a.useEffect)((function(){var e=new h.b(-32);e.toDestination(),se(e);var t=new h.i({C3:we.a});t.connect(e),E(t);var n=new h.i({C3:Me.a});n.connect(e),D(n);var a=new h.i({C2:Se.a,C3:xe.a,C4:Ae.a});a.connect(e),k(a);var c=new h.i({C3:Re.a});c.connect(e),I(c);var r=new h.i({C3:Ue.a});r.connect(e),d(r);var o=new h.i({C3:Ue.a});o.connect(e),v(o);var u=new h.i({C3:Je.a});u.connect(e),z(u);var s=new h.i({C3:Ge.a});s.connect(e),W(s);var l=new h.i({C3:We.a});l.connect(e),ne(l);var p=new h.i({C3:Ve.a});p.connect(e),oe(p);var f=new h.i({C3:Ne.a});f.connect(e),$(f);var b=new h.i({C3:He.a});b.connect(e),Y(b),i().on("connect",(function(){console.log("client connected")}))}),[]),Object(a.useEffect)((function(){r("".concat(_,"/").concat(t.hallId,"/applaude"),(function(e,t){j.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/talk"),(function(e,t){S.triggerAttackRelease(20+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/shout"),(function(e,t){A.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/singAlong"),(function(e,t){M.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/enter"),(function(e,t){l.triggerAttackRelease(72,20)})),r("".concat(_,"/").concat(t.hallId,"/leave"),(function(e,t){console.log("user left",t)})),r("".concat(_,"/").concat(t.hallId,"/photograph"),(function(e,t){H.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/phone"),(function(e,t){P.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/walk"),(function(e,t){te.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/dance"),(function(e,t){re.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/sneeze"),(function(e,t){X.triggerAttackRelease(40+Math.round(60*Math.random()),20)})),r("".concat(_,"/").concat(t.hallId,"/cough"),(function(e,t){Q.triggerAttackRelease(50+Math.round(60*Math.random()),20)}))}),[t.hallId,j,S,M,te,P,H,re,Q,X,l,g]),c.a.createElement(Ke,null,Qe.map((function(e){return c.a.createElement(Le,{key:e,variant:"outlined",color:"primary",onClick:function(){o("".concat(_,"/").concat(t.hallId,"/").concat(e),{userId:t.userId})}},e)})))};function Ze(){var e=Object(i.a)(["\n    width: 100%;\n    height: 100%;\n"]);return Ze=function(){return e},e}var et=d.a.div(Ze()),tt=function(){var e=Object(l.g)().id,t=Object(a.useContext)(q),n=Object(p.a)(t,2),r=n[0],o=n[1],i=U().publish;return Object(a.useEffect)((function(){o(Object(A.a)({},r,{hallId:e})),i("".concat(_,"/").concat(e,"/enter"),{userId:r.userId})}),[e]),c.a.createElement(et,null,c.a.createElement(je,{className:"orchestra",id:e}),c.a.createElement(ue,{className:"audience",id:e}),c.a.createElement(Ye,{className:"interactions",id:e}))};function nt(){var e=Object(i.a)(["\n  width: 100vw;\n  height: 100vh;\n"]);return nt=function(){return e},e}var at=d.a.div(nt()),ct=function(){return c.a.createElement(at,null,c.a.createElement(u.a,{store:ae},c.a.createElement(s.a,null,c.a.createElement(l.c,null,c.a.createElement(l.a,{path:"/halls/:id"},c.a.createElement(J,{value:q},c.a.createElement(tt,null))),c.a.createElement(l.a,{path:"/"},c.a.createElement(C,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(ct,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},198:function(e,t,n){e.exports=n.p+"static/media/enter.339b495d.mp3"},864:function(e){e.exports=JSON.parse('{"name":"vgig","homepage":"https://thomasgeissl.github.io/vgig","version":"0.1.0","private":true,"dependencies":{"@material-ui/core":"^4.11.0","@material-ui/icons":"^4.9.1","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.3.2","@testing-library/user-event":"^7.1.2","drei":"^1.5.7","gh-pages":"^3.1.0","mqtt":"^4.2.1","nosleep.js":"^0.11.0","react":"^16.13.1","react-dom":"^16.13.1","react-redux":"^7.2.1","react-router-dom":"^5.2.0","react-scripts":"3.4.3","react-spring":"^8.0.27","react-three-fiber":"^5.0.1","redux":"^4.0.5","redux-observable":"^1.2.0","styled-components":"^5.2.0","three":"^0.120.1","threejs-meshline":"^2.0.12","tone":"^14.7.39","typescript":"^4.0.3"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","deploy":"yarn build && gh-pages -d build","travisdeploy":"CI=false yarn build && gh-pages -d build -r https://$GH_TOKEN@github.com/thomasgeissl/vgig.git"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},869:function(e,t,n){e.exports=n.p+"static/media/unacorda_C3.4c254059.mp3"},870:function(e,t,n){e.exports=n.p+"static/media/jarbleambiencepad_C3.3312bc03.mp3"},880:function(e,t,n){e.exports=n.p+"static/media/clapping.31212348.mp3"},881:function(e,t,n){e.exports=n.p+"static/media/talk_C2.4fdd1dcf.mp3"},882:function(e,t,n){e.exports=n.p+"static/media/talk_C3.f2a775cc.mp3"},883:function(e,t,n){e.exports=n.p+"static/media/talk_C4.cfab9d69.mp3"},884:function(e,t,n){e.exports=n.p+"static/media/shout.b39ade0c.mp3"},885:function(e,t,n){e.exports=n.p+"static/media/singAlong.6896ef66.mp3"},886:function(e,t,n){e.exports=n.p+"static/media/sneeze.62f3207f.mp3"},887:function(e,t,n){e.exports=n.p+"static/media/cough.9e20177b.mp3"},888:function(e,t,n){e.exports=n.p+"static/media/photograph.437bf6fd.mp3"},889:function(e,t,n){e.exports=n.p+"static/media/phone.9417a5f0.mp3"},890:function(e,t,n){e.exports=n.p+"static/media/walk.6a028ea7.mp3"},891:function(e,t,n){e.exports=n.p+"static/media/dance.b39ade0c.mp3"},915:function(e,t,n){e.exports=n(1044)},919:function(e,t,n){},935:function(e,t){},937:function(e,t){}},[[915,1,2]]]);
//# sourceMappingURL=main.6b39a8d2.chunk.js.map